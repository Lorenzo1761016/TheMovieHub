<div class="container">
    <div class="row">
        <div class="col-md-3">
            <div style= "width: 350px" class="list-group">
                <a style = "cursor: pointer" onclick ="openTab('b1')" class="list-group-item visitor">
                    <h3 class="pull-right">
                        <i class="fa fa-eye"></i>
                    </h3>
                    <h4 id = "count" class="list-group-item-heading count">
                        1000</h4> 
                    <p class="list-group-item-text">
                        Visite Globali</p>
                </a><a style = "cursor: pointer" onclick = "openTab('b2')" class="list-group-item facebook-like">
                    <h3 class="pull-right">
                        <i class="fa fa-hand-pointer"></i>
                    </h3>
                    <h4 id = "count1" class="list-group-item-heading count">
                        1000</h4>
                    <p class="list-group-item-text">
                        Interazioni Totali</p>
                </a>
            </div>
        </div>
        <div class="col-md-3">
            <div style= "margin-left: 100px;width: 350px" class="list-group">
                <a style = "cursor:pointer" onclick = "openTab('b3')" class= "list-group-item tumblr" do %>
                    <h3 class="pull-right">
                        <i class="far fa-user"></i>
                    </h3>
                    <h4 id = "count4" class="list-group-item-heading count">
                        1000</h4>
                    <p class="list-group-item-text">
                        Utenti Totali</p>
                </a>
                <a style = "cursor: pointer" onclick = "openTab('b4')" class = "list-group-item twitter" do %>
                    <h3 class="pull-right">
                        <i class="fa fa-twitter-square"></i>
                    </h3>
                    <h4 id = "count5" class="list-group-item-heading count">
                        1000</h4>
                    <p class="list-group-item-text">
                        Utenti Twitter</p>
                </a>
            </div>
        </div>
        <div class="col-md-3">
            <div style= "margin-left: 200px;width: 350px" class="list-group">
                <%= link_to result_path(@top_film_id), class:"list-group-item google-plus" do %>
                    <h3 style = "margin-bottom: 15px" class="pull-right">
                    <i class="fas fa-film"></i>
                    </h3>
                    <h4 id = "count2" class="list-group-item-heading count">
                        1000</h4>
                    <p class="list-group-item-text">
                        <%= @top_film %> </p>
                <% end %>
                <%= link_to tv_path(@top_tv_id), class:"list-group-item purple" do %>
                    <h3 class="pull-right">
                        <i class="far fa-play-circle"></i>
                    </h3>
                    <h4 id = "count3" class="list-group-item-heading count">
                        1000</h4>
                    <p class="list-group-item-text">
                        <%= @top_tv %></p>
                <% end %>
            </div>
    </div>
</div>


<h1>Stats</h1>
<div id = "b1" class = "containerTab" style = "display: none">
    VISITE TOTALI: <%= @count %>
    <br>
    <% @visits.each do |v| %>
        <%= v.id %>)
        DISPOSTIVO: <%= v.device_type %> - 
        SISTEMA OPERATIVO: <%= v.os %> - 
        BROWSER <%= v.browser %> - 
        INIZIO SESSIONE: <%= v.started_at %>
        <br>
    <% end  %>
</div>

<div id = "b2" class = "containerTab" style = "display: none">
    EVENTI TOTALI: <%= @event_count%>
    <br>
    <% @events.each do |e| %>
        <%= e.id %>)
        <%= e.name %> - 
        <%= e.time %>
        <br>
    <% end %>
</div>

<div id = "b3" class = "containerTab" style = "display:none">
    <% @users.each do |u| %>
        <%= link_to user_path(u.id) do %>
            <%= u.username %>
        <% end %>
        <br>
        VISITE: <%= u.visits.count%>
        <br>
        <% u.visits.each do |v| %>
            <%= v.id %>) 
            DISPOSTIVO: <%= v.device_type %> - 
            SISTEMA OPERATIVO: <%= v.os %> -
            BROWSER: <%= v.browser %> -
            INIZIO SESSIONE: <%= v.started_at %>

            <br>

        <% end %>
    
        EVENTI: <%= u.events.count%>
        <br> 

        
        <% u.events.each do |e| %>
            <%= e.id %>)
            <%= e.name %> -
            <%= e.time %>
            <br>
        <% end %>  

        <% end %>
</div>

<div id = "b4" class = "containerTab" style = "display: none">
    <% @users.each do |u| %>
        <% if u.provider == "twitter"%>
            <%= link_to user_path(u.id) do %>
                <%= u.username %>
            <% end %>
            <br>
            VISITE: <%= u.visits.count%>
            <br>
            <% u.visits.each do |v| %>
                <%= v.id %>) 
                DISPOSTIVO: <%= v.device_type %> - 
                SISTEMA OPERATIVO: <%= v.os %> -
                BROWSER: <%= v.browser %> -
                INIZIO SESSIONE: <%= v.started_at %>

                <br>

            <% end %>
        
            EVENTI: <%= u.events.count%>
            <br> 

            
            <% u.events.each do |e| %>
                <%= e.id %>)
                <%= e.name %> -
                <%= e.time %>
                <br>
                <br>
            <% end %>  
        <% end %>
    <% end %>
</div>
<style>

@import url("http://netdna.bootstrapcdn.com/font-awesome/4.0.3/css/font-awesome.min.css");
body { margin-top:20px; }
.fa { font-size: 50px;text-align: right;position: absolute;top: 7px;right: 27px;outline: none; }
.fas { font-size: 50px;text-align: right;position: absolute;top: 7px;right: 27px;outline: none; }
.far { font-size: 50px;text-align: right;position: absolute;top: 7px;right: 27px;outline: none; }

a { transition: all .3s ease;-webkit-transition: all .3s ease;-moz-transition: all .3s ease;-o-transition: all .3s ease; }
/* Visitor */
a.visitor i,.visitor h4.list-group-item-heading { color:#E48A07; }
a.visitor:hover { background-color:#E48A07; }
a.visitor:hover * { color:#FFF; }
/* Facebook */
a.facebook-like i,.facebook-like h4.list-group-item-heading { color:#3b5998; }
a.facebook-like:hover { background-color:#3b5998; }
a.facebook-like:hover * { color:#FFF; }
/* Google */
a.google-plus i,.google-plus h4.list-group-item-heading { color:#dd4b39; }
a.google-plus:hover { background-color:#dd4b39; }
a.google-plus:hover * { color:#FFF; }
/* Twitter */
a.twitter i,.twitter h4.list-group-item-heading { color:#00acee; }
a.twitter:hover { background-color:#00acee; }
a.twitter:hover * { color:#FFF; }
/* Linkedin */
a.linkedin i,.linkedin h4.list-group-item-heading { color:#0e76a8; }
a.linkedin:hover { background-color:#0e76a8; }
a.linkedin:hover * { color:#FFF; }
/* Tumblr */
a.tumblr i,.tumblr h4.list-group-item-heading { color:#5C5757; }
a.tumblr:hover { background-color:#5C5757; }
a.tumblr:hover * { color:#FFF; }
/* Youtube */
a.youtube i,.youtube h4.list-group-item-heading { color:#c4302b; }
a.youtube:hover { background-color:#c4302b; }
a.youtube:hover * { color:#FFF; }
/* Vimeo */
a.vimeo i,.vimeo h4.list-group-item-heading { color:#44bbff; }
a.vimeo:hover { background-color:#44bbff; }
a.vimeo:hover * { color:#FFF; }

a.purple i,.purple h4.list-group-item-heading { color: purple; }
a.purple:hover { background-color:purple; }
a.purple:hover * { color:#FFF; }

</style>

<script>
$({ someValue: 0 }).animate({ someValue: '<%= @count %>' }, {
    duration: 3000,
    easing: 'swing', // can be anything
    step: function () { // called on every step
        // Update the element's text with rounded-up value:
        $('#count').text(commaSeparateNumber(Math.round(this.someValue)));
    }
});

$({ someValue: 0 }).animate({ someValue: '<%= @event_count %>' }, {
    duration: 3000,
    easing: 'swing', // can be anything
    step: function () { // called on every step
        // Update the element's text with rounded-up value:
        $('#count1').text(commaSeparateNumber(Math.round(this.someValue)));
    }
});


$({ someValue: 0 }).animate({ someValue: '<%= @top_film_count %>' }, {
    duration: 3000,
    easing: 'swing', // can be anything
    step: function () { // called on every step
        // Update the element's text with rounded-up value:
        $('#count2').text(commaSeparateNumber(Math.round(this.someValue)));
    }
});


$({ someValue: 0 }).animate({ someValue: '<%= @top_tv_count %>' }, {
    duration: 3000,
    easing: 'swing', // can be anything
    step: function () { // called on every step
        // Update the element's text with rounded-up value:
        $('#count3').text(commaSeparateNumber(Math.round(this.someValue)));
    }
});

$({ someValue: 0 }).animate({ someValue: '<%= @users.size %>' }, {
    duration: 3000,
    easing: 'swing', // can be anything
    step: function () { // called on every step
        // Update the element's text with rounded-up value:
        $('#count4').text(commaSeparateNumber(Math.round(this.someValue)));
    }
});

$({ someValue: 0 }).animate({ someValue: '<%= @twitter_users %>' }, {
    duration: 3000,
    easing: 'swing', // can be anything
    step: function () { // called on every step
        // Update the element's text with rounded-up value:
        $('#count5').text(commaSeparateNumber(Math.round(this.someValue)));
    }
});




function commaSeparateNumber(val) {
    while (/(\d+)(\d{3})/.test(val.toString())) {
        val = val.toString().replace(/(\d)(?=(\d\d\d)+(?!\d))/g, "$1,");
    }
    return val;
}


// Hide all elements with class="containerTab", except for the one that matches the clickable grid column
function openTab(tabName) {
  var i, x;
  x = document.getElementsByClassName("containerTab");
  for (i = 0; i < x.length; i++) {
    x[i].style.display = "none";
  }
  document.getElementById(tabName).style.display = "block";
}

</script>